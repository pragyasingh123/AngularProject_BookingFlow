<div class="search-form-container">
  <mat-dialog-actions class="close-btn" (click)="onClose()">
    <span class="material-icons" mat-dialog-close>clear</span>
  </mat-dialog-actions>
  <div class="srchformrow-header">
    <mat-tab-group animationDuration="0ms" [(selectedIndex)]="tabIndex" *ngIf="!isSeason && !isFlexi">
      <mat-tab label="Single">
        <form [formGroup]="qttFormSingle" (ngSubmit)="onClickSubmit(qttFormSingle)">

          <div class="singleQTT">
            <div class="srchformrow">
              <div class="srchformcol">
                <mat-form-field class="example-full-width default-input" floatLabel="never" appearance="none">
                  <input matInput placeholder="Departing from..." (click)="onLocationChanges(1,11)" required
                    formControlName="departureLocationNameSingle" [matAutocomplete]="departureAutoSingle">
                  <mat-autocomplete #departureAutoSingle="matAutocomplete">
                    <mat-option *ngFor="let departure of filteredDeparturesSingle | async"
                      [value]="departure.description">
                      {{departure.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormSingle.get('departureLocationNameSingle').errors && isSubmitted">
                  <div *ngIf="qttFormSingle.get('departureLocationNameSingle').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormSingle.get('departureLocationNameSingle').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
              <div class="exch-btn-wrapper">
                <button mat-icon-button aria-label="" (click)="onChangeStationsSearchSingle();">
                  <mat-icon>swap_horiz</mat-icon>
                </button>
              </div>
              <div class="srchformcol">
                <mat-form-field class="example-full-width default-input" floatLabel="never" appearance="none">
                  <input matInput placeholder="Going to..." (click)="onLocationChanges(1,12)" required
                    formControlName="arrivalLocationNameSingle" [matAutocomplete]="arrivalAutoSingle">
                  <mat-autocomplete #arrivalAutoSingle="matAutocomplete">
                    <mat-option *ngFor="let arrival of filteredArrivalsSingle | async" [value]="arrival.description">
                      {{arrival.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormSingle.get('arrivalLocationNameSingle').errors && isSubmitted">
                  <div *ngIf="qttFormSingle.get('arrivalLocationNameSingle').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormSingle.get('arrivalLocationNameSingle').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
            </div>
            <div class="srchformrow">
              <div class="srchformcol2 via-fields">
                <mat-form-field floatLabel="never" class="via-select">
                  <mat-label>Via/Avoid</mat-label>
                  <mat-select (selectionChange)="onPathConstraintChange($event, 1)"
                    formControlName="pathConstraintTypeSingle">
                    <mat-option value="">Via/Avoid</mat-option>
                    <mat-option value="VIA">Via</mat-option>
                    <mat-option value="AVOID">Avoid</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field class="via-txtbox" appearance="none">
                  <input matInput placeholder="Enter Station..." (click)="onLocationChanges(1,13)"
                    formControlName="pathConstraintLocationSingle" [matAutocomplete]="stationAutoSingle">
                  <mat-autocomplete #stationAutoSingle="matAutocomplete">
                    <mat-option *ngFor="let station of filteredStationsSingle | async" [value]="station.description">
                      {{station.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>

                <div *ngIf="qttFormSingle.get('pathConstraintLocationSingle').errors">
                  <div *ngIf="qttFormSingle.get('pathConstraintLocationSingle').hasError('required')">
                    <span style="color: #fff;">Please select a staion to continue.</span>
                  </div>
                </div>
                <!-- <div *ngIf="qttFormSingle.get('pathConstraintLocationSingle').value.length == 1">
        <span style="color: #fff;">Please enter 2 or more character.</span>
    </div>  -->
              </div>

              <div class="srchformcol2 three-select-field">
                <mat-form-field floatLabel="never" class="datepicker-fix">
                  <mat-label>{{currentdate}}</mat-label>
                  <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker3"
                    formControlName="startDateSingle" (dateInput)="onDateChangeSingle($event)" required>
                  <mat-datepicker-toggle matSuffix [for]="picker3">
                    <mat-icon matDatepickerToggleIcon>expand_more</mat-icon>
                  </mat-datepicker-toggle>
                  <mat-datepicker #picker3></mat-datepicker>
                </mat-form-field>
                <div *ngIf="qttFormSingle.get('startDateSingle').errors && isSubmitted">
                  <div *ngIf="qttFormSingle.get('startDateSingle').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>

                <mat-form-field floatLabel="never" class="">
                  <mat-label>Arrived By</mat-label>
                  <mat-select matInput formControlName="travelTypeSingle" (selectionChange)="onTravelTypeChange(1)"
                    required>

                    <mat-option value="ARRIVEBY">Arrive By</mat-option>
                    <mat-option value="DEPARTAFTER">Depart After</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field floatLabel="never" class="">
                  <mat-label>Time</mat-label>
                  <mat-select formControlName="startTimeSingle" (selectionChange)="onTimeChange(1)" required>
                    <mat-option *ngFor="let time of timeList" [value]="time">{{time}}</mat-option>
                  </mat-select>
                </mat-form-field>
                <div *ngIf="qttFormSingle.get('startTimeSingle').errors">
                  <div *ngIf="qttFormSingle.get('startTimeSingle').hasError('required') && isSubmitted">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                  <div *ngIf="qttFormSingle.get('startTimeSingle')?.errors.validTime" style="color: #fff;">
                    <span class="validation-error">Selected time can't be in past.</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="srchformrow align-items-start  position-relative">

              <div class="srchformcol2 via-fields category">
                <mat-form-field floatLabel="never" class="via-select" appearance="none">
                  <label class="fixed-label">{{isPluralAdultSingle==true?'Adults':'Adult'}}</label>
                  <mat-select (click)="clickEvent()" matInput (selectionChange)="adultChangeActionSingle($event)"
                    formControlName="adultCountSingle">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>
                  <!-- <label for="" class="fixed-label">Adult</label> -->
                </mat-form-field>

                <mat-form-field floatLabel="never" class="via-select child">
                  <label class="fixed-label">{{isPluralChildSingle==true?'Children':'Child'}}</label>
                  <mat-select class="" formControlName="childCountSingle"
                    (selectionChange)="childChangeActionSingle($event)">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>
                  <!-- <label for="" class="fixed-label">Child</label> -->
                </mat-form-field>
                <div *ngIf="qttFormSingle.get('adultCountSingle').errors">
                  <div *ngIf="qttFormSingle.get('adultCountSingle')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="qttFormSingle.get('childCountSingle').errors">
                  <div *ngIf="qttFormSingle.get('childCountSingle')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="showGroupTravelLinkSingle">
                  <span style="color: #fff;">Booking for 10 or more, please visit our Group travel
                    page.</span>
                </div>
              </div>

              <div class="srchformcol2 via-fields railcardfields">
                <mat-accordion>
                  <mat-expansion-panel [expanded]="false" #mepSingle="matExpansionPanel">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        {{counter}} Railcard(s)
                      </mat-panel-title>

                    </mat-expansion-panel-header>

                    <div class="mt-n3" formArrayName="railcardsSingle"
                      *ngFor="let railcard of qttFormSingle.get('railcardsSingle')?.controls; let i = index;">

                      <div class="srchformcol2 three-select-field railcard-select-field w-100" [formGroupName]="i">

                        <mat-form-field floatLabel="never" class="">
                          <mat-label>Type</mat-label>
                          <mat-select (selectionChange)="onRailcardActionChangeSingle(i)"
                            formControlName="railCardCode">
                            <mat-option *ngFor="let railcard of railCards" [value]="railcard.railcardcode">
                              {{railcard.railcarddescription}}</mat-option>
                          </mat-select>
                        </mat-form-field>

                        <mat-form-field floatLabel="never" class="w-20">
                          <mat-label>Count</mat-label>

                          <mat-select (selectionChange)="onRailcardCountChangeSingle(i, $event)"
                            formControlName="railcardCount">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                          </mat-select>
                        </mat-form-field>
                        <button mat-button type="button" class="railcardtype-close"
                          (click)="$event.stopPropagation();removeRailcardSingle(i)">
                          <mat-icon>add_circle_outline</mat-icon>
                        </button>
                      </div>




                      <div class="" [formGroupName]="i">
                        <div class="srchformcol2 three-select-field railcard-nosofadult-field w-100">


                          <mat-form-field floatLabel="never" class="">
                            <mat-label>0</mat-label>
                            <mat-select (click)="clickEvent()" matInput formControlName="railcardAdult"
                              (selectionChange)="adultChangeRailcards(i, $event)">
                              <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                              </mat-option>
                            </mat-select>
                            <label for="" class="fixed-label">Adult</label>
                          </mat-form-field>
                          <mat-form-field floatLabel="never" class="">
                            <mat-label>0</mat-label>
                            <mat-select formControlName="railcardChild"
                              (selectionChange)="childChangeRailcards(i, $event)">
                              <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                              </mat-option>
                            </mat-select>
                            <label for="" class="fixed-label">Child</label>
                          </mat-form-field>

                        </div>
                      </div>

                      <div *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardCount'])?.errors">
                        <div *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardCount'])?.errors.railcardValid">
                          <span style="color: black"> Errors due to railcard count.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardAdult'])?.errors">
                        <div *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardAdult'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard adult.</span>
                        </div>
                      </div>
                      <div
                        *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardChild'])?.errors && !qttFormSingle.get(['railcardsSingle', i, 'railcardAdult'])?.errors">
                        <div *ngIf="qttFormSingle.get(['railcardsSingle', i, 'railcardChild'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard child.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormSingle.get('i.railCardCode')?.errors">
                        <div *ngIf="qttFormSingle.get('i.railCardCode')?.errors.railcardValid">
                          <span style="color: #fff;">Number of railcards can't be more than
                            passengers.</span>
                        </div>
                      </div>

                      <div class="mt-2"
                        *ngIf="isRailcardSelectedSingle && isRailcardCountSelectedSingle && isShowAddMoreButton && railcardCompleted">
                        <div class="btn-fullwidthcust">
                          <button mat-flat-button (click)="$event.stopPropagation();addRailcardSingle()">Add another
                            railcard</button>
                        </div>
                      </div>

                      <div class="row mt-2 btn-fullwidthcust mr-0 ml-0">
                        <div class="col-6 col-sm-6 pl-0"> <button mat-flat-button
                            (click)="[mepSingle.expanded = !mepSingle.expanded, onCancel(1)]">Cancel</button></div>
                        <div class="col-6 col-sm-6 pr-0"> <button mat-flat-button
                            (click)="mepSingle.expanded = !mepSingle.expanded">Done</button></div>
                      </div>
                    </div>

                  </mat-expansion-panel>

                </mat-accordion>

              </div>
            </div>
            <div class="srchformrow">
              <div class="btn-fullwidthcust">
                <button mat-button class="default-btn w-100" type="submit" [disabled]="!qttFormSingle.valid">Search
                  Tickets</button>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>


      <mat-tab label="Return">
        <form [formGroup]="qttFormReturn" (ngSubmit)="onClickSubmit(qttFormReturn)">
          <div class="returnQTT">
            <div class="srchformrow">
              <div class="srchformcol">
                <!-- <button mat-button class="routingicon" type="button" (click)="onChangeStationsSearchReturn();">
                <img src="../../../../assets/images/routing_icon.png" alt=""></button>  -->
                <mat-form-field class="example-full-width default-input" floatLabel="never">
                  <input matInput placeholder="Departing from..." (click)="onLocationChanges(2,21)" required
                    formControlName="departureLocationNameReturn" [matAutocomplete]="departureAutoReturn">
                  <mat-autocomplete #departureAutoReturn="matAutocomplete">
                    <mat-option *ngFor="let departure of filteredDeparturesReturn | async"
                      [value]="departure.description">{{departure.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormReturn.get('departureLocationNameReturn').errors && isSubmitted">
                  <div *ngIf="qttFormReturn.get('departureLocationNameReturn').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormReturn.get('departureLocationNameReturn').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
              <div class="exch-btn-wrapper">
                <button mat-icon-button aria-label="" (click)="onChangeStationsSearchReturn();">
                  <mat-icon>swap_horiz</mat-icon>
                </button>
              </div>
              <div class="srchformcol">
                <mat-form-field class="example-full-width default-input" floatLabel="never">
                  <input matInput placeholder="Going to..." (click)="onLocationChanges(2,22)" required
                    formControlName="arrivalLocationNameReturn" [matAutocomplete]="arrivalAutoReturn">
                  <mat-autocomplete #arrivalAutoReturn="matAutocomplete">
                    <mat-option *ngFor="let arrival of filteredArrivalsReturn | async" [value]="arrival.description">
                      {{arrival.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormReturn.get('arrivalLocationNameReturn').errors && isSubmitted">
                  <div *ngIf="qttFormReturn.get('arrivalLocationNameReturn').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormReturn.get('arrivalLocationNameReturn').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
            </div>

            <div class="srchformrow align-items-start  position-relative">
              <div class="srchformcol2 via-fields">
                <mat-form-field floatLabel="never" class="via-select">
                  <mat-label>Via/Avoid</mat-label>
                  <mat-select (selectionChange)="onPathConstraintChange($event, 2)"
                    formControlName="pathConstraintTypeReturn">
                    <mat-option value="">Via</mat-option>
                    <mat-option value="AVOID">Avoid</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field class="via-txtbox" appearance="none">
                  <input matInput placeholder="Enter Station ..." (click)="onLocationChanges(2,23)"
                    formControlName="pathConstraintLocationReturn" [matAutocomplete]="stationAutoReturn">
                  <mat-autocomplete #stationAutoReturn="matAutocomplete">
                    <mat-option *ngFor="let station of filteredStationsReturn | async" [value]="station.description">
                      {{station.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>


                <!-- <div *ngIf="qttFormReturn.get('pathConstraintLocationReturn').errors">
                  <div *ngIf="qttFormReturn.get('pathConstraintLocationReturn').hasError('required')">
                    <span style="color: #fff;">Please select a staion to continue.</span>
                  </div>
                </div> -->

                <!-- <div *ngIf="qttFormReturn.get('pathConstraintLocationReturn').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div> -->

              </div>
              <!-- choose date start -->
              <div class="srchformcol2 three-select-field">
                <mat-form-field floatLabel="never" class="datepicker-fix">
                  <mat-label>{{currentdate}}</mat-label>
                  <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker"
                    formControlName="startDateReturn" (dateInput)="onDateChangeReturn($event)">
                  <mat-datepicker-toggle matSuffix [for]="picker">
                    <mat-icon matDatepickerToggleIcon>expand_more</mat-icon>
                  </mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                  <div *ngIf="qttFormReturn.get('startDateReturn').errors && isSubmitted">
                    <div *ngIf="qttFormReturn.get('startDateReturn').hasError('required')">
                      <span style="color: #fff;">It is required field.</span>
                    </div>
                  </div>
                </mat-form-field>

                <mat-form-field floatLabel="never" class="">
                  <mat-label>Depart After</mat-label>
                  <mat-select matInput (selectionChange)="onTravelTypeChange(2)" formControlName="travelTypeReturn"
                    required>

                    <mat-option value="ARRIVEBY">Arrive By</mat-option>
                    <mat-option value="DEPARTAFTER">Depart After</mat-option>
                  </mat-select>
                </mat-form-field>
                <div *ngIf="qttFormReturn.get('travelTypeReturn').errors && isSubmitted">
                  <div *ngIf="qttFormReturn.get('travelTypeReturn').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>

                <mat-form-field floatLabel="never" class="">
                  <mat-label>Time</mat-label>
                  <mat-select (selectionChange)="onStartTimeReturnChange($event)" formControlName="startTimeReturn"
                    required>
                    <mat-option *ngFor="let time of timeList" [value]="time">{{time}}</mat-option>

                  </mat-select>
                  <div *ngIf="qttFormReturn.get('startTimeReturn').errors">
                    <div *ngIf="qttFormReturn.get('startTimeReturn').hasError('required') && isSubmitted">
                      <span style="color: #fff;">It is required field.</span>
                    </div>
                    <div *ngIf="qttFormReturn.get('startTimeReturn')?.errors.validTime" style="color: #fff;">
                      <span class="validation-error">Selected time can't be in past.</span>
                    </div>
                  </div>
                </mat-form-field>

              </div>
              <!-- choose date end -->
            </div>

            <div class="srchformrow align-items-start  position-relative">
              <!-- no of person field start -->
              <div class="srchformcol2 via-fields category">
                <mat-form-field floatLabel="never" class="via-select">
                  <label class="fixed-label">{{isPluralAdultReturn==true?'Adults':'Adult'}}</label>
                  <mat-select (click)="clickEvent()" (selectionChange)="adultChangeActionReturn($event)"
                    formControlName="adultCountReturn">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>

                </mat-form-field>
                <mat-form-field floatLabel="never" class="via-select child">
                  <label class="fixed-label">{{isPluralChildReturn==true?'Children':'Child'}}</label>
                  <mat-select formControlName="childCountReturn" (selectionChange)="childChangeActionReturn($event)">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>

                </mat-form-field>

                <div *ngIf="qttFormReturn.get('adultCountReturn').errors">
                  <div *ngIf="qttFormReturn.get('adultCountReturn')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="qttFormReturn.get('childCountReturn').errors">
                  <div *ngIf="qttFormReturn.get('childCountReturn')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="showGroupTravelLinkReturn">
                  <span style="color: #fff;">Booking for 10 or more, please visit our Group travel
                    page.</span>
                </div>
              </div>
              <!-- no of person field end -->
              <!-- choose date start -->
              <div class="srchformcol2 three-select-field rtrnDprt">
                <mat-form-field floatLabel="never" class="datepicker-fix">
                  <mat-label>Return Date</mat-label>
                  <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker2"
                    formControlName="returnDateReturn" (dateInput)="onReturnDateChangeReturn($event)">
                  <mat-datepicker-toggle matSuffix [for]="picker2">
                    <mat-icon matDatepickerToggleIcon>expand_more</mat-icon>
                  </mat-datepicker-toggle>
                  <mat-datepicker #picker2></mat-datepicker>
                </mat-form-field>
                <div *ngIf="qttFormReturn.get('returnDateReturn').errors && isSubmitted">
                  <div *ngIf="qttFormReturn.get('returnDateReturn').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>
                <mat-form-field floatLabel="never" class="">
                  <mat-label>Depart After</mat-label>
                  <mat-select [(ngModel)]="returnTravelType" formControlName="returnTravelTypeReturn" required>
                    <mat-option value="ARRIVEBY">Arrive By</mat-option>
                    <mat-option value="DEPARTAFTER">Depart After</mat-option>
                  </mat-select>
                </mat-form-field>
                <div *ngIf="qttFormReturn.get('returnTravelTypeReturn').errors && isSubmitted">
                  <div *ngIf="qttFormReturn.get('returnTravelTypeReturn').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>
                <mat-form-field floatLabel="never" class="">
                  <mat-label>Time</mat-label>
                  <mat-select formControlName="returnTimeReturn" required>
                    <mat-option *ngFor="let time of timeList" [value]="time">{{time}}</mat-option>

                  </mat-select>
                </mat-form-field>

                <div *ngIf="qttFormReturn.get('returnTimeReturn').errors">
                  <div *ngIf="qttFormReturn.get('returnTimeReturn').hasError('required') && isSubmitted">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                  <div *ngIf="qttFormReturn.get('returnTimeReturn')?.errors.validTime" style="color: #fff;">
                    <span class="validation-error">Selected time can't be in past.</span>
                  </div>
                  <div *ngIf="qttFormReturn.get('returnTimeReturn')?.errors.validReturnTime" style="color: #fff;">
                    <span class="validation-error">Return must take place after outbound journey.</span>
                  </div>
                </div>

              </div>
              <!-- choose date end -->

            </div>
            <div class="srchformrow align-items-start">
              <div class="srchformcol2 via-fields railcardfields" [@.disabled]="disableAnimation">
                <mat-accordion>
                  <mat-expansion-panel [expanded]="false" #mepReturn="matExpansionPanel">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        {{counterReturn}} Railcard(s)
                      </mat-panel-title>

                    </mat-expansion-panel-header>

                    <div class="mt-n3" formArrayName="railcardsReturn"
                      *ngFor="let railcard of qttFormReturn.get('railcardsReturn').controls; let i = index;">
                      <div class="srchformcol2 three-select-field railcard-select-field w-100" [formGroupName]="i">

                        <mat-form-field floatLabel="never" class="">
                          <mat-label>Type</mat-label>
                          <mat-select (selectionChange)="onRailcardActionChangeReturn(i)"
                            formControlName="railCardCode">
                            <mat-option *ngFor="let railcard of railCards" [value]="railcard.railcardcode">
                              {{railcard.railcarddescription}}</mat-option>
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field floatLabel="never" class="w-20">
                          <mat-label>Count</mat-label>
                          <mat-select (selectionChange)="onRailcardCountChangeReturn(i, $event)"
                            formControlName="railcardCount">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                        <button mat-button type="button" class="railcardtype-close"
                          (click)="$event.stopPropagation();removeRailcardReturn(i)">
                          <mat-icon>add_circle_outline</mat-icon>
                        </button>
                      </div>
                      <div class="srchformcol2 three-select-field railcard-nosofadult-field w-100" [formGroupName]="i">


                        <mat-form-field floatLabel="never" class="">
                          <mat-label>0</mat-label>
                          <mat-select (click)="clickEvent()" matInput formControlName="railcardAdult"
                            (selectionChange)="adultChangeRailcardsReturn(i, $event)">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                          <label for="" class="fixed-label">Adult</label>
                        </mat-form-field>
                        <mat-form-field floatLabel="never" class="">
                          <mat-label>0</mat-label>
                          <mat-select formControlName="railcardChild"
                            (selectionChange)="childChangeRailcardsReturn(i, $event)">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                          <label for="" class="fixed-label">Child</label>
                        </mat-form-field>

                      </div>

                      <div *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardCount'])?.errors">
                        <div *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardCount'])?.errors.railcardValid">
                          <span style="color: black"> Errors due to railcard count.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardAdult'])?.errors">
                        <div *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardAdult'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard adult.</span>
                        </div>
                      </div>
                      <div
                        *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardChild'])?.errors && !qttFormSingle.get(['railcardsSingle', i, 'railcardAdult'])?.errors">
                        <div *ngIf="qttFormReturn.get(['railcardsReturn', i, 'railcardChild'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard child.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormReturn.get('i.railCardCode')?.errors">
                        <div *ngIf="qttFormReturn.get('i.railCardCode')?.errors.railcardValid">
                          <span style="color: #fff;">Number of railcards can't be more than
                            passengers.</span>
                        </div>
                      </div>
                    </div>

                    <div class="row mt-2"
                      *ngIf="isRailcardSelectedReturn && isRailcardCountSelectedReturn && isShowAddMoreButtonReturn && railcardCompletedReturn">
                      <div class="col-12 col-sm-6 btn-fullwidthcust">
                        <button mat-flat-button (click)="$event.stopPropagation();addRailcardReturn()">Add another
                          railcard</button>
                      </div>
                    </div>

                    <div class="row mt-2 btn-fullwidthcust mr-0 ml-0">
                      <div class="col-6 col-sm-6 pl-0"> <button mat-flat-button
                          (click)="[mepReturn.expanded = !mepReturn.expanded, onCancel(2)]">Cancel</button></div>
                      <div class="col-6 col-sm-6 pr-0"> <button mat-flat-button
                          (click)="mepReturn.expanded = !mepReturn.expanded">Done</button></div>
                    </div>


                  </mat-expansion-panel>

                </mat-accordion>

              </div>

              <div class="srchformcol2 btn-fullwidthcust">
                <button mat-button class="default-btn w-100" type="submit" [disabled]="!qttFormReturn.valid">Search
                  Tickets</button>
              </div>

            </div>
          </div>
        </form>
      </mat-tab>

      <mat-tab label="Open Return">
        <form [formGroup]="qttFormOpenReturn" (ngSubmit)="onClickSubmit(qttFormOpenReturn)">
          <div class="singleQTT">
            <div class="srchformrow">
              <div class="srchformcol">
                <mat-form-field class="example-full-width default-input" floatLabel="never">
                  <input matInput placeholder="Departing from..." (click)="onLocationChanges(3,31)" required
                    formControlName="departureLocationNameOpenReturn" [matAutocomplete]="departureAutoOpenReturn">
                  <mat-autocomplete #departureAutoOpenReturn="matAutocomplete">
                    <mat-option *ngFor="let departure of filteredDeparturesOpenReturn | async"
                      [value]="departure.description">
                      {{departure.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormOpenReturn.get('departureLocationNameOpenReturn').errors && isSubmitted">
                  <div *ngIf="qttFormOpenReturn.get('departureLocationNameOpenReturn').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormOpenReturn.get('departureLocationNameOpenReturn').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
              <div class="exch-btn-wrapper">
                <button mat-icon-button aria-label="" (click)="onChangeStationsSearchOpenReturn();">
                  <mat-icon>swap_horiz</mat-icon>
                </button>
              </div>
              <div class="srchformcol">
                <mat-form-field class="example-full-width default-input" floatLabel="never">
                  <input matInput placeholder="Going to..." (click)="onLocationChanges(3,32)" required
                    formControlName="arrivalLocationNameOpenReturn" [matAutocomplete]="arrivalAutoOpenReturn">
                  <mat-autocomplete #arrivalAutoOpenReturn="matAutocomplete">
                    <mat-option *ngFor="let arrival of filteredArrivalsOpenReturn | async"
                      [value]="arrival.description">
                      {{arrival.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <div *ngIf="qttFormOpenReturn.get('arrivalLocationNameOpenReturn').errors && isSubmitted">
                  <div *ngIf="qttFormOpenReturn.get('arrivalLocationNameOpenReturn').hasError('required')">
                    <span style="color: #fff;">It is required a field.</span>
                  </div>
                </div>
                <div *ngIf="qttFormOpenReturn.get('arrivalLocationNameOpenReturn').value.length < 2">
                  <span style="color: #fff;">Please enter 2 or more character.</span>
                </div>
              </div>
            </div>
            <div class="srchformrow">
              <div class="srchformcol2 via-fields">
                <mat-form-field floatLabel="never" class="via-select">
                  <mat-label>Via/Avoid</mat-label>
                  <mat-select class="search-via-select" (selectionChange)="onPathConstraintChange($event, 3)"
                    formControlName="pathConstraintTypeOpenReturn">
                    <mat-option value="VIA">Via</mat-option>
                    <mat-option value="AVOID">Avoid</mat-option>
                  </mat-select>
                </mat-form-field>

                <mat-form-field class="via-txtbox" appearance="none">
                  <input matInput placeholder="Enter Station ..." formControlName="pathConstraintLocationOpenReturn"
                    (click)="onLocationChanges(3,33)" [matAutocomplete]="stationAutoOpenReturn">
                  <mat-autocomplete #stationAutoOpenReturn="matAutocomplete">
                    <mat-option *ngFor="let station of filteredStationsOpenReturn| async" [value]="station.description">
                      {{station.description}}</mat-option>
                  </mat-autocomplete>
                </mat-form-field>
              </div>
              <!-- <div *ngIf="qttFormOpenReturn.get('pathConstraintLocationOpenReturn').errors">
                <div *ngIf="qttFormOpenReturn.get('pathConstraintLocationOpenReturn').hasError('required')">
                    <span style="color: #fff;">Please select a staion to continue.</span>
                </div>
            </div> -->
              <div class="srchformcol2 three-select-field">
                <mat-form-field floatLabel="never" class="datepicker-fix">
                  <mat-label>{{currentdate}}</mat-label>
                  <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker4"
                    formControlName="startDateOpenReturn" (dateInput)="onDateChangeOpenReturn($event)" required>
                  <mat-datepicker-toggle matSuffix [for]="picker4">
                    <mat-icon matDatepickerToggleIcon>expand_more</mat-icon>
                  </mat-datepicker-toggle>
                  <mat-datepicker #picker4></mat-datepicker>
                </mat-form-field>
                <div *ngIf="qttFormOpenReturn.get('startDateOpenReturn').errors && isSubmitted">
                  <div *ngIf="qttFormOpenReturn.get('startDateOpenReturn').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>

                <mat-form-field floatLabel="never" class="">
                  <mat-label>Arrived By</mat-label>
                  <mat-select formControlName="travelTypeOpenReturn" (selectionChange)="onTravelTypeChange(3)" required>
                    <mat-option value="ARRIVEBY">Arrive By</mat-option>
                    <mat-option value="DEPARTAFTER">Depart After</mat-option>
                  </mat-select>
                </mat-form-field>
                <div *ngIf="qttFormOpenReturn.get('travelTypeOpenReturn').errors && isSubmitted">
                  <div *ngIf="qttFormOpenReturn.get('travelTypeOpenReturn').hasError('required')">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                </div>
                <mat-form-field floatLabel="never" class="">
                  <mat-label>Time</mat-label>
                  <mat-select formControlName="startTimeOpenReturn" (selectionChange)="onTimeChange(3)" required>
                    <mat-option *ngFor="let time of timeList" [value]="time">{{time}}</mat-option>
                  </mat-select>
                </mat-form-field>

                <div *ngIf="qttFormOpenReturn.get('startTimeOpenReturn').errors">
                  <div *ngIf="qttFormOpenReturn.get('startTimeOpenReturn').hasError('required') && isSubmitted">
                    <span style="color: #fff;">It is required field.</span>
                  </div>
                  <div *ngIf="qttFormOpenReturn.get('startTimeOpenReturn')?.errors.validTime">
                    <span style="color: #fff;">Selected Time can't be in past.</span>
                  </div>
                </div>

              </div>


            </div>
            <div class="srchformrow align-items-start  position-relative">

              <div class="srchformcol2 via-fields category">
                <mat-form-field floatLabel="never" class="via-select">
                  <label class="fixed-label">{{isPluralAdultOpenReturn==true?'Adults':'Adult'}}</label>
                  <mat-select (click)="clickEvent()" (selectionChange)="adultChangeActionOpenReturn($event)"
                    formControlName="adultCountOpenReturn">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>

                </mat-form-field>
                <mat-form-field floatLabel="never" class="via-select child">
                  <label class="fixed-label">{{isPluralChildOpenReturn==true?'Children':'Child'}}</label>
                  <mat-select formControlName="childCountOpenReturn"
                    (selectionChange)="childChangeActionOpenReturn($event)">
                    <mat-option *ngFor="let count of counts" [value]="count">{{count}}</mat-option>
                  </mat-select>

                </mat-form-field>
                <div *ngIf="qttFormOpenReturn.get('adultCountOpenReturn').errors">
                  <div *ngIf="qttFormOpenReturn.get('adultCountOpenReturn')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="qttFormOpenReturn.get('childCountOpenReturn').errors">
                  <div *ngIf="qttFormOpenReturn.get('childCountOpenReturn')?.errors.passengerCount">
                    <span style="color: #fff;">Minimum 1 passenger required.</span>
                  </div>
                </div>
                <div *ngIf="showGroupTravelLinkOpenReturn">
                  <span style="color: #fff;">Booking for 10 or more, please visit our Group travel
                    page.</span>
                </div>
              </div>
              <div class="srchformcol2 via-fields railcardfields" [@.disabled]="disableAnimation">
                <mat-accordion>
                  <mat-expansion-panel [expanded]="false" #mepOpenReturn="matExpansionPanel">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        {{counterOpenReturn}} Railcard(s)
                      </mat-panel-title>

                    </mat-expansion-panel-header>

                    <div class="mt-n3" formArrayName="railcardsOpenReturn"
                      *ngFor="let railcard of qttFormOpenReturn.get('railcardsOpenReturn').controls; let i = index;">
                      <div class="srchformcol2 three-select-field railcard-select-field w-100" [formGroupName]="i">


                        <mat-form-field floatLabel="never" class="">
                          <mat-label>Type</mat-label>
                          <mat-select (selectionChange)="onRailcardActionChangeOpenReturn(i)"
                            formControlName="railCardCode">
                            <mat-option *ngFor="let railcard of railCards" [value]="railcard.railcardcode">
                              {{railcard.railcarddescription}}</mat-option>
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field floatLabel="never" class="w-20">
                          <mat-label>Count</mat-label>
                          <mat-select (selectionChange)="onRailcardCountChangeOpenReturn(i, $event)"
                            formControlName="railcardCount">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                        <button mat-button type="button" class="railcardtype-close"
                          (click)="$event.stopPropagation();removeRailcardOpenReturn(i)">
                          <mat-icon>add_circle_outline</mat-icon>
                        </button>
                      </div>



                      <div class="srchformcol2 three-select-field railcard-nosofadult-field w-100" [formGroupName]="i">


                        <mat-form-field floatLabel="never" class="">
                          <mat-label>0</mat-label>
                          <mat-select (click)="clickEvent()" matInput formControlName="railcardAdult"
                            (selectionChange)="adultChangeRailcardsOpenReturn(i, $event)">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                          <label for="" class="fixed-label">Adult</label>
                        </mat-form-field>
                        <mat-form-field floatLabel="never" class="">
                          <mat-label>0</mat-label>
                          <mat-select formControlName="railcardChild"
                            (selectionChange)="childChangeRailcardsOpenReturn(i, $event)">
                            <mat-option *ngFor="let count of counts" [value]="count">{{count}}
                            </mat-option>
                          </mat-select>
                          <label for="" class="fixed-label">Child</label>
                        </mat-form-field>

                      </div>
                      <div *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardCount'])?.errors">
                        <div
                          *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardCount'])?.errors.railcardValid">
                          <span style="color: black"> Errors due to railcard count.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardAdult'])?.errors">
                        <div
                          *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardAdult'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard adult.</span>
                        </div>
                      </div>
                      <div
                        *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardChild'])?.errors && !qttFormSingle.get(['railcardsSingle', i, 'railcardAdult'])?.errors">
                        <div
                          *ngIf="qttFormOpenReturn.get(['railcardsOpenReturn', i, 'railcardChild'])?.errors.railcardValid">
                          <span style="color: black">Errors due to railcard child.</span>
                        </div>
                      </div>
                      <div *ngIf="qttFormOpenReturn.get('i.railCardCode')?.errors">
                        <div *ngIf="qttFormOpenReturn.get('i.railCardCode')?.errors.railcardValid">
                          <span style="color: #fff;">Number of railcards can't be more than
                            passengers.</span>
                        </div>
                      </div>

                      <div class="mt-2"
                        *ngIf="isRailcardSelectedOpenReturn && isRailcardCountSelectedOpenReturn && isShowAddMoreButtonOpenReturn && railcardCompletedOpenReturn">
                        <div class="btn-fullwidthcust">
                          <button mat-flat-button (click)="$event.stopPropagation();addRailcardOpenReturn()">Add another
                            railcard</button>
                        </div>
                      </div>

                      <div class="row mt-2 btn-fullwidthcust mr-0 ml-0">
                        <div class="col-6 col-sm-6 pl-0"> <button mat-flat-button
                            (click)="[mepOpenReturn.expanded = !mepOpenReturn.expanded, onCancel(3)]">Cancel</button>
                        </div>
                        <div class="col-6 col-sm-6 pr-0"> <button mat-flat-button
                            (click)="mepOpenReturn.expanded = !mepOpenReturn.expanded">Done</button></div>
                      </div>
                    </div>

                  </mat-expansion-panel>

                </mat-accordion>

              </div>
            </div>
            <div class="srchformrow">
              <div class="btn-fullwidthcust">
                <button mat-button class="default-btn w-100" type="submit" [disabled]="!qttFormOpenReturn.valid">Search
                  Tickets</button>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>